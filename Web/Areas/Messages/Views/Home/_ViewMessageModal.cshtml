@using System.Web
@using Application.Areas.Messages.ViewModels
@using Web.Extensions

@model ReadMessageVm
@{
    string modalId = Model.IsSentMessage ? "sentMessageModal" : "viewMessageModal";
}

<div class="modal santa-modal" tabindex="-1" id="@modalId" data-close-url="@Url.Action(Context, "MarkMessageRead", "Home", "Messages")" 
    data-message-key="@Model.MessageKey" data-message-recipient-key="@Model.MessageRecipientKey" data-read="@Model.Read">

    <div class="modal-dialog modal-lg">
        <div class="modal-content">            
            <partial name="Modal/_ModalHeader" />

            <div class="modal-body">
                <div class="row @CenterFlexNoWrapContainer">
                    
                    @if (Model.LaterMessages.Any())
                    {
                        <div class="alert alert-info col-11">
                            This is not the latest message in the conversation. Please see 'Later Messages' below.
                        </div>
                    }

                    <partial name="_ViewMessageDetails" />

                    @if (Model.LaterMessages.Any())
                    {
                        <div class="col-11">
                            <h2>Later Messages</h2>

                            @foreach (var message in Model.LaterMessages)
                            {
                                <partial name="_PreviousMessageDetails" model="@message" />
                            }
                        </div>
                    }

                    @if (Model.PreviousMessages.Any())
                    {
                        <div class="col-11">
                            <h2>Previous Messages</h2>

                            @foreach (var message in Model.PreviousMessages)
                            {
                                <partial name="_PreviousMessageDetails" model="@message" />
                            }
                        </div>
                    }
                </div>
            </div>

            <partial name="Modal/_ModalFooter" />
        </div>
    </div>
</div>