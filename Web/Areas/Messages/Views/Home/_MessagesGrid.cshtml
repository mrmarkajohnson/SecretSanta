@using Global.Abstractions.Global.Messages
@using Global.Extensions.System
@using NonFactors.Mvc.Grid
@using Web.Helpers

@model IQueryable<IReadMessage>
@{
    Func<IReadMessage, object> actions =
    @<text>
        <a class="modal-link" data-url="@Url.Action(Context.Request, "ViewMessage", "Home", "Messages", new { id = item.Id })"
           data-toggle="tooltip" title="View Message">
            <i class="fa fa-eye"></i>
        </a>
    </text> ;
}

@(Html
    .Grid(Model)
    .Build(columns =>
    {
        columns.Add(x => x.Sent).RenderedAs(x => x.Sent.ToDateTimeString()).Titled("Sent");
        columns.Add(x => x.SenderName).Titled("From");
        columns.Add(x => x.RecipientTypes).RenderedAs(x => x.RecipientTypes.DisplayName()).Titled("To");
        columns.Add(x => x.HeaderText).Titled("Subject");
        columns.Add().RenderedAs(actions).Encoded(false);
    })
    @* .Pageable(pager =>
    {
        pager.PageSizes = new Dictionary<int, string> { { 0, "All" }, { 10, "10" }, { 20, "20" }, { 50, "50" } };
        pager.ShowPageSizes = true;
    }) *@
    .Empty("No messages found")
    .Id("messages-grid")
    .Filterable()
    .Sortable()
    .RowAttributed(model => new { @class = (model.Important ? "bold " : "") + (!model.Read ? "text-danger" : "") })
)
