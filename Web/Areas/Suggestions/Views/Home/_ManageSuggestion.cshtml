@using Application.Areas.Suggestions.ViewModels

@model ManageSuggestionVm
@{
    string suggestionExplanation = "Add a short description of your suggestion";
    string notesExplanation = "Add any other relevant information, including any links, items to avoid, size details etc.";
    string priorityExplanation = $"A sort order between 1 and {PriorityLimit}; items with priority 1 appear first";
}

<partial name="_FormHiddenInputs" />

<div class="row @CenterFlexNoWrapContainer">

    <div class="collapse">
        <input type="hidden" asp-for="SuggestionKey" />
    </div>

    <div class="mb-5">
        <partial name="Modal/_OptionalModalContentHeader" />

        <div class="@CenterFlexWrapContainer">
            <div class="@Model.GroupWidth">

                <div class="mb-3">
                    <label asp-for="SuggestionText" class="control-label required"></label>
                    <div class="input-group input-info">
                        <input asp-for="SuggestionText" class="form-control" aria-required="true" />
                        <partial name="_InputQuestion" model="@suggestionExplanation" />
                    </div>
                    <div>
                        <span asp-validation-for="SuggestionText" class="text-danger"></span>
                    </div>
                </div>

                <div class="mb-3">
                    <label asp-for="OtherNotes" class="control-label"></label>
                    <div class="input-group input-info">
                        <div class="flex-grow-1"> @* This is needed to handle the flex group *@
                            <div class="collapse">
                                <input type="hidden" asp-for="OtherNotes" class="summernote-content" />
                            </div>

                            <div class="summernote form-control"></div>
                        </div>
                        <partial name="_InputQuestion" model="@notesExplanation" />
                    </div>
                    <div>
                        <span asp-validation-for="OtherNotes" class="text-danger"></span>
                    </div>
                </div>

                <div class="mb-3">
                    <label asp-for="Priority" class="control-label required"></label>
                    <div class="input-group input-info">
                        <input asp-for="PrioritySetter" type="number" min="1" max="@PriorityLimit" class="form-control" aria-required="false" />
                        <partial name="_InputQuestion" model="@priorityExplanation" />
                    </div>
                    <div>
                        <span asp-validation-for="PrioritySetter" class="text-danger"></span>
                    </div>
                </div>

                @if (Model.YearGroupUserLinks.Count > 0)
                {
                    <div class="mb-3">
                        <label asp-for="YearGroupUserLinks" class="control-label required"></label>
                        
                        <div class="d-flex" style="flex-wrap: wrap !important">
                            @for (int i = 0; i < Model.YearGroupUserLinks.Count; i++)
                            {
                                var link = @Model.YearGroupUserLinks[i];
                                string labelClass = link.Included ? "" : "text-grey";

                                <div class="collapse">
                                    <input type="hidden" asp-for="YearGroupUserLinks[i].GiftingGroupKey" />
                                    <input type="hidden" asp-for="YearGroupUserLinks[i].CalendarYear" />
                                    <input type="hidden" asp-for="YearGroupUserLinks[i].SuggestionLinkKey" />
                                    <input type="hidden" asp-for="YearGroupUserLinks[i].YearGroupUserKey" />
                                    <input type="hidden" asp-for="YearGroupUserLinks[i].GiftingGroupName" />
                                    <input type="hidden" asp-for="YearGroupUserLinks[i].Included" />
                                </div>

                                <span class="nowrap">
                                    <span class="@labelClass">@link.GiftingGroupName</span>
                                    <text>&nbsp;</text>
                                    <input type="checkbox" class="apply-group-checkbox" asp-for="YearGroupUserLinks[i].ApplyToGroup"
                                        data-included="@link.Included" data-group="@link.GiftingGroupName" />

                                    @if (i < Model.YearGroupUserLinks.Count - 1)
                                    {
                                        <text>
                                            &nbsp;
                                            &nbsp;
                                            &nbsp;
                                            &nbsp;
                                        </text>
                                    }
                                </span>
                            }
                        </div>
                    </div>
                }

            </div>
        </div>

        <partial name="Modal/_OptionalModalContentFooter" />
    </div>

</div>