@using Application.Areas.Home.ViewModels
@inject IWebHostEnvironment environment

<!DOCTYPE html>
<html lang="en" class="h-100">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - SecretSanta</title>

    <script>
        FontAwesomeConfig = { autoReplaceSvg: false }
    </script>

    <link rel="stylesheet" href="~/css/bootstrap.custom.min.css" />
    <link rel="stylesheet" href="~/lib/fontawesome-free/css/all.min.css" />
    <link rel="stylesheet" href="~/lib/toastr/toastr.css" /> @* This is after Bootstrap to preserve the original styling *@
    <link rel="stylesheet" href="~/css/site.min.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/mvc-grid/mvc-grid.css" />
    <link rel="stylesheet" href="~/lib/summernote/summernote-bs5.css" />
</head>

<body class="d-flex flex-column h-100">
    <div class="snow">
        <div class="snow-layer1 a"></div>
        <div class="snow-layer1"></div>
        <div class="snow-layer2 a"></div>
        <div class="snow-layer2"></div>
        <div class="snow-layer3 a"></div>
        <div class="snow-layer3"></div>
    </div>
    
    <partial name="_Header" />

    <div class="container flex-grow-1 snow-background">       
        <main role="main" class="d-flex flex-column" style="margin: 0 !important; width: 100% !important; height: 100% !important">
            <div class="wrapper row flex-grow-1" style="position: relative">
                <div class="thinking justify-content-center text-center align-middle" style="display: none !important">
                    <div class="d-flex flex-column" style="margin: 0 !important; width: 100% !important; height: 100% !important">
                        <div class="row flex-grow-1 col-12 align-items-center d-flex flex-column">
                            <div class="row flex-grow-1"></div>
                            <div class="row">
                                <h3>Please wait, Santa's elves are working on it...</h3>
                            </div>
                            <div class="row">
                                <div>
                                    <img src="~/img/dancing-elves.gif" height="225px !important" width="300px !important" 
                                        style="max-height: 225px !important; max-width: 300px !important; vertical-align: top !important" />
                                </div>
                            </div>
                            <div class="row flex-grow-1"></div>
                        </div>
                    </div>
                </div>
                <div class="pt-4 pb-4 ps-4 pe-4 text-center">
                    @RenderBody()
                </div>
            </div>

            @section Scripts {
                <partial name="_ValidationScripts" />
            }

        </main>
    </div>
    
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/bootbox/bootbox.min.js"></script>
    <script src="~/js/mvc-grid/mvc-grid.js"></script>

    <environment include="Development">
        <script src="~/lib/toastr/toastr.min.js" asp-append-version="true"></script>
        <script src="~/js/site.js" asp-append-version="true"></script>
        <script src="~/js/global.js" asp-append-version="true"></script>
    </environment>
    <environment exclude="Development">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js" asp-append-version="true"></script>
        <script src="~/js/site.min.js" asp-append-version="true"></script>
        <script src="~/js/global.min.js" asp-append-version="true"></script>
    </environment>
    
    <partial name="_Footer" />

    <script src="~/lib/summernote/summernote-bs5.js"></script>

    <script>
        [].forEach.call(document.getElementsByClassName('mvc-grid'), function (element) {
            new MvcGrid(element);
        });
    </script>

    @{
        string relativePath = Context.Request.Path.ToString().Trim('/');
        string bundlePath = $"js/{relativePath}/" + (environment.IsDevelopment() ? "bundle.js" : "bundle.min.js");

        string absolutePath = System.IO.Path.GetFullPath($"wwwroot/{bundlePath}");
        if (System.IO.File.Exists(absolutePath))
        {
            <script src="~/@bundlePath"></script>
        }

        await RenderSectionAsync("Scripts", required: false);
    }
</body>
</html>
