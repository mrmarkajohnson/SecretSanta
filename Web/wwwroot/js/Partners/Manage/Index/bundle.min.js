function initStatusSelects(){let n=document.querySelectorAll("select.relationship-status-select"),t=document.querySelector("div.relationships-table").getAttribute("data-change-url"),i=new URL(t);n.forEach(function(n){n.setAttribute("data-original-value",n.value);n.getAttribute("data-initialised")||(n.setAttribute("data-initialised",!0),n.addEventListener("change",function(t){let r=n.getAttribute("data-original-value");if(n.value!=r){let r=n.getAttribute("data-name"),u="Change relationship status",f="Are you sure you want to change the status of your relationship with "+r+"?";n.value=="NotRelationship"&&(u="Deny suggesteed relationship",f="You're NOT in a relationship with "+r+", is that correct?");relationshipStatusChanged(t.currentTarget,i,u,f)}}))})}function initDeleteLinks(){let n=document.querySelectorAll("a.delete-relationship-link"),t=document.querySelector("div.relationships-table").getAttribute("data-delete-url"),i=new URL(t);n.forEach(function(n){n.getAttribute("data-initialised")||(n.setAttribute("data-initialised",!0),n.setAttribute("data-original-value","null"),n.addEventListener("click",function(t){let r=n.getAttribute("data-name"),u="Are you sure you want to delete your proposed relationship with "+r+"?";relationshipStatusChanged(t.currentTarget,i,"Delete relationship",u)}))})}async function relationshipStatusChanged(n,t,i,r){async function f(){let f=n.getAttribute("data-link-id"),e=n.getAttribute("data-user-id");t.searchParams.set("partnerLinkKey",f);t.searchParams.set("globalUserId",e);t.searchParams.set("newStatus",n.value);let i=await fetch(t.href,{method:"POST",redirect:"follow"});await i;document.dispatchEvent(new Event("ajaxComplete"));let r=await i.text();i.redirected?window.location.href=i.url:i.ok?(n.setAttribute("data-original-value",n.value),reloadGrid()):n.value=u;i.redirected||r==null||r==""||(i.ok?showSuccessMessage(r):showErrorMessage(r))}let u=n.getAttribute("data-original-value");bootbox.confirm({title:i,message:r,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-no"}},callback:function(t){bootbox.hideAll();t?f():n.value=u}})}async function relationshipModalOpening(n){let t=n.detail.modal;t.id=="manageRelationshipModal"}async function relationshipModalSaved(n){let t=n.detail.modal;t.id=="manageRelationshipModal"&&reloadGrid()}window.addEventListener("load",function(){initStatusSelects();initDeleteLinks()});document.addEventListener("modalOpening",function(n){relationshipModalOpening(n)});document.addEventListener("modalSaved",function(n){relationshipModalSaved(n)});
//# sourceMappingURL=bundle.min.js.map