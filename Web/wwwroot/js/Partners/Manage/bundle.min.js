function initRelatinoshipStatusSelects(){let n=document.querySelectorAll("select.relationship-status-select"),t=document.querySelector("div.relationships-table").getAttribute("data-change-url"),i=new URL(t);n.forEach(function(n){n.setAttribute("data-original-value",n.value);n.getAttribute("data-initialised")||(n.setAttribute("data-initialised",!0),n.addEventListener("change",function(t){let r=n.getAttribute("data-original-value");if(n.value!=r){let r=n.getAttribute("data-name"),u="Change relationship status",f="Are you sure you want to change the status of your relationship with "+r+"?";n.value=="NotRelationship"&&(u="Deny suggesteed relationship",f="You're NOT in a relationship with "+r+", is that correct?");relationshipStatusChanged(t.currentTarget,i,u,f)}}))})}function initDeleteRelationshipLinks(){let n=document.querySelectorAll("a.delete-relationship-link"),t=document.querySelector("div.relationships-table").getAttribute("data-delete-url"),i=new URL(t);n.forEach(function(n){n.getAttribute("data-initialised")||(n.setAttribute("data-initialised",!0),n.setAttribute("data-original-value","null"),n.addEventListener("click",function(t){let r=n.getAttribute("data-name"),u="Are you sure you want to delete your proposed relationship with "+r+"?";relationshipStatusChanged(t.currentTarget,i,"Delete relationship",u)}))})}async function relationshipStatusChanged(n,t,i,r){async function f(){let f=n.getAttribute("data-link-id"),e=n.getAttribute("data-hashed-user-id");t.searchParams.set("partnerLinkKey",f);t.searchParams.set("hashedUserId",e);t.searchParams.set("newStatus",n.value);let i=await fetch(t.href,{method:"POST",redirect:"follow"});await i;document.dispatchEvent(new Event("ajaxComplete"));let r=await i.text();i.redirected?window.location.href=i.url:i.ok?(n.setAttribute("data-original-value",n.value),reloadGrid()):n.value=u;i.redirected||r==null||r==""||(i.ok?showSuccessMessage(r):showErrorMessage(r))}let u=n.getAttribute("data-original-value");bootbox.confirm({title:i,message:r,buttons:{confirm:{label:"Yes",className:"btn-success"},cancel:{label:"No",className:"btn-no"}},callback:function(t){bootbox.hideAll();t?f():n.value=u}})}async function relationshipModalOpening(n){let t=n.detail.modal;t.id=="manageRelationshipModal"&&relationshipModalOpened(t)}function relationshipModalOpened(n){let t=n.querySelector(".now-options-section");t&&manageNowOptions(n,t)}function manageNowOptions(n,t){let u=n.querySelector(".ever-options-section"),i=n.querySelector(".exchange-options-section"),e=t.querySelector("input[type=radio].radio-no"),f=t.querySelector("input[type=radio].radio-yes"),o=t.querySelector("input[type=radio].radio-not-sure"),r=f.checked;if(u){hideSection(u);let t=u.querySelector("input[type=radio].radio-no"),s=u.querySelector("input[type=radio].radio-yes"),h=u.querySelector("input[type=radio].radio-not-sure");if(i){let s=i.querySelector("input[type=radio].radio-no"),c=i.querySelector("input[type=radio].radio-yes"),l=i.querySelector("input[type=radio].radio-not-sure");e.addEventListener("click",function(){h()});f.addEventListener("click",function(){hideSection(u);hideSection(i);t.checked=!0;s.checked=!0;r=!0});o.addEventListener("click",function(){h()});function h(){showSection(u);showSection(i);r&&(n(),a());r=!1}function a(){s.checked=c.checked=l.checked=!1}}else e.addEventListener("click",function(){showSection(u);r&&n();r=!1}),f.addEventListener("click",function(){hideSection(u);s.checked=!0;r=!0}),o.addEventListener("click",function(){showSection(u);r&&n();r=!1});function n(){t.checked=s.checked=h.checked=!1}}else if(i){let n=i.querySelector("input[type=radio].radio-no"),u=i.querySelector("input[type=radio].radio-yes"),s=i.querySelector("input[type=radio].radio-not-sure");e.addEventListener("click",function(){showSection(i);r&&t();r=!1});f.addEventListener("click",function(){hideSection(i);n.checked=!0;r=!0});o.addEventListener("click",function(){showSection(i);r&&t();r=!1});function t(){n.checked=u.checked=s.checked=!1}}}function showSection(n){n.classList.contains("collapse")&&n.classList.remove("collapse")}function hideSection(n){n.classList.contains("collapse")||n.classList.add("collapse")}async function relationshipModalSaved(n){let t=n.detail.modal;t.id=="manageRelationshipModal"&&reloadGrid()}window.addEventListener("load",function(){initRelatinoshipStatusSelects();initDeleteRelationshipLinks()});document.addEventListener("modalOpening",function(n){relationshipModalOpening(n)});document.addEventListener("modalSaved",function(n){relationshipModalSaved(n)});
//# sourceMappingURL=bundle.min.js.map