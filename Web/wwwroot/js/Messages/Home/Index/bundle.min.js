async function writeMessageModalOpening(n){let t=n.detail.modal;t.id=="writeMessageModal"&&initSendMessage()}async function viewMessageModalClosed(n){let t=n.detail.modal;if(t.id=="viewMessageModal"){let r=t.getAttribute("data-read");if(isTrueValue(r))return!0;let n=t.getAttribute("data-close-url"),u=t.getAttribute("data-message-key"),i=t.getAttribute("data-message-recipient-key");if(!isEmptyValue(n)&&!isEmptyValue(i)){let t=new URL(n);t.searchParams.set("messageKey",u);t.searchParams.set("messageRecipientKey",i);let r=await fetch(t.href,{method:"POST"});await r;reloadGrid()}}}function initSendMessage(){async function t(n,t){isEmptyInput(n)?i(t):await r(n,t)}function i(n){let t=n.querySelector("select.recipient-type-select");t.value="TBC";t.setAttribute("disabled",!0);let i=t.parentElement.querySelector("div.input-group-text");i.setAttribute("data-bs-original-title","Please select a group first.");setTooltips()}async function r(t,i){let f=t.getAttribute("data-url"),e=new URL(f),o=new FormData(n),r=await fetch(e.href,{method:"POST",body:o});await r;let u=await getResponseText(r);isHtml(u)&&(i.innerHTML=u,initRecipientSection(n))}initSummernote();let n=document.getElementById("messageForm");if(n&&!n.getAttribute("data-initalised-wm")){n.setAttribute("data-initalised-wm",!0);let i=n.querySelector("select.gifting-group-select"),r=n.querySelector(".message-recipient-section");i&&r&&i.addEventListener("change",function(){t(i,r)});initRecipientSection(n)}}function initRecipientSection(n){let t=n.querySelector("select.recipient-type-select");if(t){let i=n.querySelector(".future-members-section"),u=i.querySelector("label.include-future-members-label"),f=i.querySelector("div.d-inline"),r=n.querySelector(".specific-recipient-section");e();t.addEventListener("change",function(){e()});function e(){function o(){r.classList.add("collapse");r.querySelector("select").value="";let t=n.getAttribute("data-future-label"),e=n.getAttribute("data-future-explanation");isEmptyValue(t)?(i.classList.add("collapse"),u.innerHTML="Include Future Members"):(i.classList.remove("collapse"),u.innerHTML=t);isEmptyValue(e)?f.setAttribute("data-bs-original-title",""):f.setAttribute("data-bs-original-title",e);setTooltips()}let n=t.options[t.selectedIndex],e=n.getAttribute("data-specific");isTrueValue(e)?(i.classList.add("collapse"),r.classList.remove("collapse")):o()}}}window.addEventListener("load",function(){let n=document.getElementById("messageKey").value,t=document.getElementById("messageRecipientKey").value;if(n>0){let r='.view-message-link[data-message-key="'+n+'"]',u=r+'[data-message-recipient-key="'+t+'"]',i=document.querySelector(u);i||(i=document.querySelector(r));i&&i.dispatchEvent(new Event("click"))}});document.addEventListener("modalOpening",function(n){writeMessageModalOpening(n)});document.addEventListener("modalClosed",function(n){viewMessageModalClosed(n)});window.addEventListener("load",function(){initSendMessage()});document.addEventListener("reloadend",function(){initSendMessage()});
//# sourceMappingURL=bundle.min.js.map